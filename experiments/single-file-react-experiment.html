<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Budgets</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
	<div id="container">
	</div>
	
	<script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
	<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>

	<script>
		'use strict';

		const e = React.createElement;
		
		class Budget extends React.Component {
			constructor(props) {
				super(props);
				
				this.state = {
					total: 550.00,
					remainingToday: 10.52,
					spentToday: 25.47,
					remainingTomorrow: 30.68,
					spentTotal: 98.34,
					entries: [
						{ id: 1, amount: -10.25, title: 'A' },
						{ id: 2, amount: -5.67, title: 'B' },
						{ id: 3, amount: -12.45, title: 'C' }
					]
				};
				
				this.addEntry = this.addEntry.bind(this);
			}

			addEntry() {
				this.setState(
					{ entries:
							[...this.state.entries, {
								id: this.state.entries.length,
								amount: Math.floor(Math.random() * 10000) / 100,
								title: Math.random().toString(36).substring(2,7)
							}]
					},
				)
			}
			
			render() {
				return e(
					'div',
					{},
					[
						e(BudgetSummary,		{
							...this.state,
							key: 'summary' 
							}),
						e(BudgetEntryForm,	{ 
							key: 'entryForm',
							handleAddEntry: this.addEntry }),
						e(BudgetEntries,		{ key: 'entries', entries: this.state.entries, foo: 'bar', qaz: ['a'] })
					]
				);
			}
		}
		
		const BudgetSummary = function(props) {
			return e(
				'div',
				{},
				[
					e('p', { key: 'remainingToday' }, props.remainingToday),
					e('p', { key: 'spentToday' }, props.spentToday),
					e('p', { key: 'remainingTomorrow' }, props.remainingTomorrow),
					e('p', { key: 'spentTotal' }, props.spentTotal),
				]
			);
		}
				
		class BudgetEntryForm extends React.Component {
			constructor(props) {
				super(props);
			}
			
			render() {
				return e(
					'form',
					{
						key: 'entryForm',
						onSubmit: (evt) => { 
							evt.preventDefault();
							this.props.handleAddEntry();
						}
					},
					[
						e('input', 
							{ 
								key: 'input', 
								type: 'number', 
								defaultValue: "0.00", step: "0.01",
								onChange: () => { console.log("change"); }
							}
						),
						e('input', 
							{ 
								key: 'submit',
								type: 'submit',
								value: 'Eintragen'
							}
						),
					]
				);
			}
		}

		const BudgetEntry = function(props) {
			return e(
				'li',
				{},
				[
					e('span', {key: 'amnt'+props.id}, props.amount),
					' ',
					e('span', {key: 'titl'+props.id}, props.title),
				]
			);
		}
		
		const BudgetEntries = function(props) {
			return e(
				'ul',
				{},
				props.entries.map(
					(x, idx) => e(BudgetEntry, {...x, key: idx}))
			);
		}
		
		const domContainer = document.querySelector('#container');
		ReactDOM.render(e(Budget), domContainer);
	</script>
</body>
</html>
